
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Windows Interface</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Inter', sans-serif;
        }

        body {
            height: 100vh;
            background-image: url('https://images.unsplash.com/photo-1673526759327-54f1f5b27322?fm=jpg&q=60&w=3000&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1yZWxhdGVkfDE0fHx8ZW58MHx8fHx8');
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            overflow: hidden;
        }

        .desktop-icons {
            display: grid;
            grid-template-columns: repeat(1, 1fr);
            gap: 15px;
            padding: 15px;
            position: relative;
            z-index: 1;
        }

        .app-icon {
            width: 70px;
            height: 90px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            padding: 10px;
            border-radius: 8px;
            animation: fadeInUp 0.5s ease backwards;
        }

        .app-icon:nth-child(1) { animation-delay: 0.1s; }
        .app-icon:nth-child(2) { animation-delay: 0.2s; }
        .app-icon:nth-child(3) { animation-delay: 0.3s; }
        .app-icon:nth-child(4) { animation-delay: 0.4s; }
        .app-icon:nth-child(5) { animation-delay: 0.5s; }

        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .icon-img {
            width: 45px;
            height: 45px;
            background: linear-gradient(45deg, #4B0082, #800080);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 22px;
            color: white;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .app-icon:hover .icon-img {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(138, 43, 226, 0.3);
            border-color: rgba(255, 255, 255, 0.2);
        }

        .icon-text {
            color: white;
            font-size: 12px;
            text-align: center;
            text-shadow: 0 1px 3px rgba(0, 0, 0, 0.5);
        }

        .taskbar {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            height: 50px;
            background: rgba(20, 20, 20, 0.85);
            backdrop-filter: blur(15px);
            display: flex;
            align-items: center;
            padding: 0 20px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        .app-launcher-button {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: rgba(138, 43, 226, 0.3);
            cursor: pointer;
            margin-right: auto;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .app-launcher-button:hover {
            background: rgba(138, 43, 226, 0.5);
            transform: scale(1.1);
        }

        .launcher-circle {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.9);
            position: relative;
            overflow: hidden;
        }

        .launcher-circle::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, rgba(138, 43, 226, 0.8), rgba(75, 0, 130, 0.8));
            opacity: 0;
            transition: all 0.3s ease;
        }

        .app-launcher-button:hover .launcher-circle::before {
            opacity: 1;
        }

        .taskbar-icons {
            display: flex;
            gap: 10px;
        }

        .taskbar-icon {
            width: 35px;
            height: 35px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(255, 255, 255, 0.1);
            cursor: pointer;
            transition: all 0.3s ease;
            color: white;
        }

        .taskbar-icon[data-app="browser"] {
            background: linear-gradient(45deg, #4B0082, #800080);
            box-shadow: 0 2px 8px rgba(138, 43, 226, 0.3);
        }

        .taskbar-icon:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
        }

        .taskbar-icon[data-app="browser"].active {
            background: linear-gradient(45deg, #800080, #4B0082);
            box-shadow: 0 0 15px rgba(138, 43, 226, 0.5);
        }

        .browser-window {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0.9);
            width: 90vw;
            height: 85vh;
            background: rgba(30, 30, 30, 0.95);
            border-radius: 12px;
            overflow: hidden;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(138, 43, 226, 0.3);
        }

        .browser-window.active {
            transform: translate(-50%, -50%) scale(1);
            opacity: 1;
            visibility: visible;
        }

        .browser-window.maximized {
            width: 100vw !important;
            height: calc(100vh - 50px) !important;
            top: 0 !important;
            left: 0 !important;
            transform: none !important;
            border-radius: 0;
        }

        .browser-window.minimized {
            transform: translate(-50%, 100vh) scale(0.5);
            opacity: 0;
            visibility: hidden;
        }

        .browser-header {
            height: 40px;
            background: rgba(40, 40, 40, 0.95);
            display: flex;
            align-items: center;
            justify-content: flex-end;
            padding: 0 15px;
            border-bottom: 1px solid rgba(138, 43, 226, 0.3);
            cursor: move;
        }

        .window-controls {
            display: flex;
            gap: 8px;
        }

        .control-button {
            width: 35px;
            height: 35px;
            border: none;
            background: transparent;
            color: #fff;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: all 0.2s ease;
        }

        .control-button:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .control-button.close:hover {
            background: rgba(255, 0, 0, 0.2);
        }

        .control-button.maximize:hover,
        .control-button.minimize:hover {
            background: rgba(138, 43, 226, 0.2);
        }

        .browser-content {
            height: calc(100% - 40px);
        }

        .browser-content iframe {
            width: 100%;
            height: 100%;
            border: none;
        }
        

.browser-window {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 90vw;
    height: 85vh;
    background: rgba(30, 30, 30, 0.95);
    border-radius: 12px;
    overflow: hidden;
    opacity: 0;
    visibility: hidden;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
    border: 1px solid rgba(138, 43, 226, 0.3);
}

.browser-content {
    height: calc(100% - 40px);
    position: relative;
    z-index: 1;
    pointer-events: auto;
}

.browser-content iframe {
    width: 100%;
    height: 100%;
    border: none;
    pointer-events: auto;
}

.browser-header {
    position: relative;
    z-index: 2;
}

/* Make desktop icons stay behind browser window */
.desktop-icons {
    display: grid;
    grid-template-columns: repeat(1, 1fr);
    gap: 15px;
    padding: 15px;
    position: relative;
    z-index: 1;
}

/* Make browser window appear above desktop icons but below taskbar */
.browser-window {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 90vw;
    height: 85vh;
    background: rgba(30, 30, 30, 0.95);
    border-radius: 12px;
    overflow: hidden;
    opacity: 0;
    visibility: hidden;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
    border: 1px solid rgba(138, 43, 226, 0.3);
    z-index: 1000; /* Add this line */
}

/* Make taskbar stay on top */
.taskbar {
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    height: 50px;
    background: rgba(20, 20, 20, 0.85);
    backdrop-filter: blur(15px);
    display: flex;
    align-items: center;
    padding: 0 20px;
    border-top: 1px solid rgba(255, 255, 255, 0.1);
    z-index: 2000; /* Add this line */
}

.browser-window.active {
    opacity: 1;
    visibility: visible;
}

/* App Window Styles */
.app-window {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%) scale(0.9);
    width: 90vw;
    height: 85vh;
    background: rgba(30, 30, 30, 0.95);
    border-radius: 12px;
    overflow: hidden;
    opacity: 0;
    visibility: hidden;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
    border: 1px solid rgba(138, 43, 226, 0.3);
    z-index: 1000;
}

.window-header {
    height: 40px;
    background: rgba(40, 40, 40, 0.95);
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 0 15px;
    border-bottom: 1px solid rgba(138, 43, 226, 0.3);
    cursor: move;
}

.window-title {
    color: white;
    font-size: 14px;
    font-weight: 600;
}

.window-content {
    height: calc(100% - 40px);
    position: relative;
}

.window-content iframe {
    width: 100%;
    height: 100%;
    border: none;
}

/* App Store Styles */
.store-content {
    padding: 20px;
    overflow-y: auto;
}

.app-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
    gap: 20px;
    padding: 20px;
}

.store-app {
    background: rgba(40, 40, 40, 0.95);
    border-radius: 12px;
    padding: 20px;
    display: flex;
    align-items: center;
    gap: 20px;
    transition: all 0.3s ease;
}

.store-app:hover {
    transform: translateY(-5px);
    box-shadow: 0 5px 15px rgba(138, 43, 226, 0.2);
}

.store-app img {
    width: 80px;
    height: 80px;
    border-radius: 12px;
}

.app-info {
    flex: 1;
}

.app-info h3 {
    color: white;
    margin-bottom: 5px;
}

.app-info p {
    color: rgba(255, 255, 255, 0.7);
    font-size: 14px;
    margin-bottom: 10px;
}

.install-btn {
    background: rgba(138, 43, 226, 0.3);
    border: none;
    color: white;
    padding: 8px 20px;
    border-radius: 8px;
    cursor: pointer;
    transition: all 0.3s ease;
}

.install-btn:hover {
    background: rgba(138, 43, 226, 0.5);
}

.installed {
    background: rgba(76, 175, 80, 0.3) !important;
}

/* Add to your existing CSS */
.browser-window, .app-window {
    resize: both;
    min-width: 400px;
    min-height: 300px;
}

.resize-handle {
    position: absolute;
    width: 10px;
    height: 10px;
    background: rgba(138, 43, 226, 0.3);
    border-radius: 50%;
    cursor: se-resize;
    bottom: 0;
    right: 0;
    z-index: 1001;
}

.window-header {
    user-select: none;
}

.app-window.active {
  display: flex;
  flex-direction: column;
}



    </style>
</head>
<body>
    <div class="desktop-icons">
        <div class="app-icon" data-app="browser">
            <div class="icon-img"><i class="fas fa-globe"></i></div>
            <span class="icon-text">Browser</span>
        </div>
        <div class="app-icon"><div class="icon-img"><i class="fas fa-folder"></i></div><span class="icon-text">Files</span></div>
        <div class="app-icon"><div class="icon-img"><i class="fas fa-cog"></i></div><span class="icon-text">Settings</span></div>

<div class="app-icon" data-app="spotify">
    <div class="icon-img"><i class="fab fa-spotify"></i></div>
    <span class="icon-text">Spotify</span>
</div>
<div class="app-icon" data-app="store">
    <div class="icon-img"><i class="fas fa-store"></i></div>
    <span class="icon-text">Store</span>
</div>


    <div class="browser-window" id="browserWindow">
        <div class="browser-header">
            <div class="window-controls">
                <button class="control-button minimize" title="Minimize"><i class="fas fa-minus"></i></button>
                <button class="control-button maximize" title="Maximize"><i class="fas fa-square"></i></button>
                <button class="control-button close" title="Close"><i class="fas fa-times"></i></button>
            </div>
        </div>
        <div class="browser-content">
            <iframe src="https://thisunblockzone.github.io/zora/"></iframe>
        </div>
    </div>

    <div class="taskbar">
        <div class="app-launcher-button"><div class="launcher-circle"></div></div>
        <div class="taskbar-icons">
            <div class="taskbar-icon" data-app="browser"><i class="fas fa-globe"></i></div>
            <div class="taskbar-icon"><i class="fas fa-folder"></i></div>
            <div class="taskbar-icon"><i class="fas fa-cog"></i></div>
            <div class="taskbar-icon"><i class="fab fa-spotify"></i></div>
            <div class="taskbar-icon"><i class="fas fa-store"></i></div>
            <div class="taskbar-icon" data-app="spotify"><i class="fab fa-spotify"></i></div>
<div class="taskbar-icon" data-app="store"><i class="fas fa-store"></i></div>

        </div>
    </div>
    
    <!-- Spotify Window -->
<div class="browser-window" id="spotifyWindow">
        <div class="browser-header">
            <div class="window-controls">
                <button class="control-button minimize" title="Minimize"><i class="fas fa-minus"></i></button>
                <button class="control-button maximize" title="Maximize"><i class="fas fa-square"></i></button>
                <button class="control-button close" title="Close"><i class="fas fa-times"></i></button>
            </div>
        </div>
        <div class="browser-content">
            <iframe src="https://thisunblockzone.github.io/zora/"></iframe>
        </div>
    </div>


<!-- App Store Window -->
<div class="browser-window" id="storeWindow">
    <div class="window-header">
        <div class="window-title">App Store</div>
        <div class="window-controls">
            <button class="control-button minimize" title="Minimize"><i class="fas fa-minus"></i></button>
            <button class="control-button maximize" title="Maximize"><i class="fas fa-square"></i></button>
            <button class="control-button close" title="Close"><i class="fas fa-times"></i></button>
        </div>
    </div>
    <div class="window-content store-content">
        <div class="app-grid">
            <div class="store-app" data-app="geforcenow">
                <img src="https://play-lh.googleusercontent.com/Kf8WTct65hFJxBUDm51uPIIc7LKQNQpGmLHTJFqKWPuqNxkZ8A9L1xRT0uW2bE_f_w=w240-h480-rw" alt="GeForce Now">
                <div class="app-info">
                    <h3>GeForce Now</h3>
                    <p>Cloud Gaming Platform</p>
                    <button class="install-btn">Install</button>
                </div>
            </div>
            <div class="store-app" data-app="tiktok">
                <img src="https://play-lh.googleusercontent.com/OS-MhSWOPtlUZLt0_UP5TI4juSf0XhyHxGfJa6JrR-64UcOqV5UxCF0C5_OVlYmyEJg=w240-h480-rw" alt="TikTok">
                <div class="app-info">
                    <h3>TikTok</h3>
                    <p>Short-form Videos</p>
                    <button class="install-btn">Install</button>
                </div>
            </div>
            <div class="store-app" data-app="poki">
                <img src="https://play-lh.googleusercontent.com/DTzWtkxfnKwFO3ruybY1SKjJQnLYeuK3KmQmwV5OQ3dULr5iXxeEtzBLceultrKTIUTr=w240-h480-rw" alt="Poki">
                <div class="app-info">
                    <h3>Poki</h3>
                    <p>Online Games</p>
                    <button class="install-btn">Install</button>
                </div>
            </div>
        </div>
    </div>
</div>


    <script>

document.addEventListener("DOMContentLoaded", () => {
    const appIcons = document.querySelectorAll(".app-icon[data-app]");
    const taskbarIcons = document.querySelectorAll(".taskbar-icon[data-app]");
    const windows = {
        browser: document.getElementById("browserWindow"),
        spotify: document.getElementById("spotifyWindow"),
        store: document.getElementById("storeWindow")
    };

    const allWindows = document.querySelectorAll(".browser-window, .app-window");

    function bringToFront(windowElement) {
        allWindows.forEach(win => win.style.zIndex = 1000);
        if (windowElement) {
            windowElement.style.zIndex = 1100;
        }
    }

    function openWindow(app) {
        const windowEl = windows[app];
        if (windowEl) {
            windowEl.classList.add("active");
            windowEl.classList.remove("minimized");
            bringToFront(windowEl);
        }
    }

    function closeWindow(button) {
        const windowEl = button.closest(".browser-window, .app-window");
        if (windowEl) {
            windowEl.classList.remove("active", "maximized", "minimized");
        }
    }

    function minimizeWindow(button) {
        const windowEl = button.closest(".browser-window, .app-window");
        if (windowEl) {
            windowEl.classList.add("minimized");
        }
    }

    function maximizeWindow(button) {
        const windowEl = button.closest(".browser-window, .app-window");
        if (windowEl) {
            windowEl.classList.toggle("maximized");
        }
    }

    appIcons.forEach(icon => {
        icon.addEventListener("click", () => {
            const app = icon.dataset.app;
            openWindow(app);
        });
    });

    taskbarIcons.forEach(icon => {
        icon.addEventListener("click", () => {
            const app = icon.dataset.app;
            const win = windows[app];
            if (!win) return;

            if (win.classList.contains("minimized")) {
                win.classList.remove("minimized");
                win.classList.add("active");
                bringToFront(win);
            } else if (win.classList.contains("active")) {
                win.classList.add("minimized");
            } else {
                win.classList.add("active");
                bringToFront(win);
            }
        });
    });

    document.querySelectorAll(".control-button.close").forEach(btn => {
        btn.addEventListener("click", () => closeWindow(btn));
    });

    document.querySelectorAll(".control-button.minimize").forEach(btn => {
        btn.addEventListener("click", () => minimizeWindow(btn));
    });

    document.querySelectorAll(".control-button.maximize").forEach(btn => {
        btn.addEventListener("click", () => maximizeWindow(btn));
    });

    // App installation from store
    document.querySelectorAll(".install-btn").forEach(btn => {
        btn.addEventListener("click", () => {
            const appContainer = btn.closest(".store-app");
            const appId = appContainer.dataset.app;
            const appName = appContainer.querySelector("h3").innerText;
            const appImg = appContainer.querySelector("img").src;

            if (windows[appId]) return alert(`${appName} is already installed.`);

            // Add app to desktop
            const desktopIcons = document.querySelector(".desktop-icons");
            const newIcon = document.createElement("div");
            newIcon.className = "app-icon";
            newIcon.dataset.app = appId;
            newIcon.innerHTML = `
                <div class="icon-img"><img src="${appImg}" style="width: 100%; height: 100%; border-radius: 10px;"></div>
                <span class="icon-text">${appName}</span>
            `;
            newIcon.addEventListener("click", () => openWindow(appId));
            desktopIcons.appendChild(newIcon);

            // Add app to taskbar
            const taskbar = document.querySelector(".taskbar-icons");
            const newTaskbarIcon = document.createElement("div");
            newTaskbarIcon.className = "taskbar-icon";
            newTaskbarIcon.dataset.app = appId;
            newTaskbarIcon.innerHTML = `<img src="${appImg}" style="width: 80%; height: 80%; border-radius: 6px;">`;
            newTaskbarIcon.addEventListener("click", () => {
                const appWin = document.getElementById(`${appId}Window`);
                if (!appWin) return;

                if (appWin.classList.contains("minimized")) {
                    appWin.classList.remove("minimized");
                    appWin.classList.add("active");
                    bringToFront(appWin);
                } else if (appWin.classList.contains("active")) {
                    appWin.classList.add("minimized");
                } else {
                    appWin.classList.add("active");
                    bringToFront(appWin);
                }
            });
            taskbar.appendChild(newTaskbarIcon);

            // Create app window
            const win = document.createElement("div");
            win.className = "app-window";
            win.id = `${appId}Window`;
            win.innerHTML = `
                <div class="window-header">
                    <div class="window-title">${appName}</div>
                    <div class="window-controls">
                        <button class="control-button minimize"><i class="fas fa-minus"></i></button>
                        <button class="control-button maximize"><i class="fas fa-square"></i></button>
                        <button class="control-button close"><i class="fas fa-times"></i></button>
                    </div>
                </div>
                <div class="window-content">
                    <iframe src="https://thisunblockzone.github.io/active/iframe.html#https://${appId}.com"></iframe>
                </div>
            `;
            document.body.appendChild(win);

            // Save reference
            windows[appId] = win;

            // Add window control listeners
            win.querySelector(".control-button.close").addEventListener("click", () => closeWindow(win));
            win.querySelector(".control-button.minimize").addEventListener("click", () => minimizeWindow(win));
            win.querySelector(".control-button.maximize").addEventListener("click", () => maximizeWindow(win));

            // Mark app as installed
            btn.innerText = "Installed";
            btn.classList.add("installed");
            btn.disabled = true;
        });
    });
});
</script>

<script>
    const appIcons = document.querySelectorAll('.app-icon');
    const taskbarIcons = document.querySelectorAll('.taskbar-icon');
    const appWindows = {
        browser: document.getElementById('browserWindow'),
        spotify: document.getElementById('spotifyWindow'),
        store: document.getElementById('storeWindow')
    };

    function openWindow(app) {
        for (const key in appWindows) {
            appWindows[key].classList.remove('active');
        }
        if (appWindows[app]) {
            appWindows[app].classList.add('active');
        }
    }

    appIcons.forEach(icon => {
        const app = icon.getAttribute('data-app');
        if (app && appWindows[app]) {
            icon.addEventListener('click', () => openWindow(app));
        }
    });

    taskbarIcons.forEach(icon => {
        const app = icon.getAttribute('data-app');
        if (app && appWindows[app]) {
            icon.addEventListener('click', () => openWindow(app));
        }
    });

    // Optional: Close buttons
    document.querySelectorAll('.control-button.close').forEach(button => {
        button.addEventListener('click', () => {
            button.closest('.app-window').classList.remove('active');
        });
    });
    
    document.addEventListener('DOMContentLoaded', () => {
    // Window elements
    const windows = {
        browser: document.getElementById('browserWindow'),
        spotify: document.getElementById('spotifyWindow'),
        store: document.getElementById('storeWindow')
    };

    // Track window states and positions
    const windowStates = {
        browser: { isActive: false, isMaximized: false, isDragging: false, zIndex: 1000 },
        spotify: { isActive: false, isMaximized: false, isDragging: false, zIndex: 1000 },
        store: { isActive: false, isMaximized: false, isDragging: false, zIndex: 1000 }
    };

    let zIndexCounter = 1000;
    let offsetX, offsetY;
    let isResizing = false;
    let currentWindow = null;
    let startWidth, startHeight, startX, startY;

    // Function to create a new browser window
    function createBrowserWindow(appName, url, title) {
        const windowId = `${appName}Window`;
        const windowDiv = document.createElement('div');
        windowDiv.className = 'browser-window';
        windowDiv.id = windowId;
        windowDiv.innerHTML = `
            <div class="browser-header">
                <div class="window-title">${title}</div>
                <div class="window-controls">
                    <button class="control-button minimize"><i class="fas fa-minus"></i></button>
                    <button class="control-button maximize"><i class="fas fa-square"></i></button>
                    <button class="control-button close"><i class="fas fa-times"></i></button>
                </div>
            </div>
            <div class="browser-content">
                <iframe src="${url}"></iframe>
            </div>
            <div class="resize-handle"></div>
        `;

        document.body.appendChild(windowDiv);
        windowStates[appName] = { isActive: false, isMaximized: false, isDragging: false, zIndex: ++zIndexCounter };
        initializeWindow(windowId, appName);
        return windowDiv;
    }

    // Function to make window draggable
    function makeDraggable(window, header) {
        header.addEventListener('mousedown', (e) => {
            if (e.target.closest('.window-controls')) return;
            
            const appName = window.id.replace('Window', '');
            if (windowStates[appName].isMaximized) return;

            windowStates[appName].isDragging = true;
            currentWindow = window;

            const rect = window.getBoundingClientRect();
            offsetX = e.clientX - rect.left;
            offsetY = e.clientY - rect.top;

            window.style.transition = 'none';
            header.style.cursor = 'grabbing';
            
            // Bring window to front
            window.style.zIndex = ++zIndexCounter;

            const mouseMoveHandler = (e) => {
                if (windowStates[appName].isDragging) {
                    const x = e.clientX - offsetX;
                    const y = e.clientY - offsetY;
                    
                    window.style.left = `${x}px`;
                    window.style.top = `${y}px`;
                    window.style.transform = 'none';
                }
            };

            const mouseUpHandler = () => {
                windowStates[appName].isDragging = false;
                header.style.cursor = 'grab';
                window.style.transition = '';
                
                document.removeEventListener('mousemove', mouseMoveHandler);
                document.removeEventListener('mouseup', mouseUpHandler);
            };

            document.addEventListener('mousemove', mouseMoveHandler);
            document.addEventListener('mouseup', mouseUpHandler);
        });
    }

    // Store functionality
    const storeWindow = document.getElementById('storeWindow');
    if (storeWindow) {
        storeWindow.style.background = 'rgba(30, 30, 30, 1)'; // Full opacity
    }

    // Handle app installation
    function installApp(appData) {
        const { appName, url, title, icon } = appData;
        
        // Create desktop icon
        const desktopIcon = document.createElement('div');
        desktopIcon.className = 'app-icon';
        desktopIcon.dataset.app = appName;
        desktopIcon.innerHTML = `
            <div class="icon-img"><i class="${icon}"></i></div>
            <span class="icon-text">${title}</span>
            <button class="delete-app" data-app="${appName}">×</button>
        `;

        document.querySelector('.desktop-icons').appendChild(desktopIcon);

        // Add click handler
        desktopIcon.addEventListener('click', () => {
            const existingWindow = document.getElementById(`${appName}Window`);
            if (existingWindow) {
                existingWindow.classList.add('active');
                existingWindow.style.zIndex = ++zIndexCounter;
            } else {
                const newWindow = createBrowserWindow(appName, url, title);
                newWindow.classList.add('active');
            }
        });

        // Add delete handler
        const deleteBtn = desktopIcon.querySelector('.delete-app');
        deleteBtn.addEventListener('click', (e) => {
            e.stopPropagation();
            const windowToRemove = document.getElementById(`${appName}Window`);
            if (windowToRemove) {
                windowToRemove.remove();
            }
            desktopIcon.remove();
            delete windowStates[appName];
            
            // Update localStorage
            const installedApps = JSON.parse(localStorage.getItem('installedApps') || '[]');
            const updatedApps = installedApps.filter(app => app !== appName);
            localStorage.setItem('installedApps', JSON.stringify(updatedApps));
        });

        // Save to localStorage
        const installedApps = JSON.parse(localStorage.getItem('installedApps') || '[]');
        if (!installedApps.includes(appName)) {
            installedApps.push(appName);
            localStorage.setItem('installedApps', JSON.stringify(installedApps));
        }
    }

    // Initialize existing windows
    Object.keys(windows).forEach(appName => {
        const window = windows[appName];
        if (window) {
            const header = window.querySelector('.browser-header');
            if (header) {
                makeDraggable(window, header);
            }
        }
    });

    // Store apps click handlers
    document.querySelectorAll('.store-app').forEach(app => {
        const installBtn = app.querySelector('.install-btn');
        const appName = app.dataset.app;
        
        installBtn.addEventListener('click', () => {
            if (!installBtn.classList.contains('installed')) {
                const appData = {
                    appName,
                    url: getAppUrl(appName),
                    title: app.querySelector('h3').textContent,
                    icon: getAppIcon(appName)
                };
                
                installApp(appData);
                installBtn.textContent = 'Installed';
                installBtn.classList.add('installed');
            }
        });
    });

    // Helper function to get app URL
    function getAppUrl(appName) {
        const urls = {
            geforcenow: 'https://play.geforcenow.com',
            tiktok: 'https://tiktok.com',
            poki: 'https://poki.com'
            // Add more apps as needed
        };
        return urls[appName] || '';
    }

    // Helper function to get app icon
    function getAppIcon(appName) {
        const icons = {
            geforcenow: 'fas fa-gamepad',
            tiktok: 'fab fa-tiktok',
            poki: 'fas fa-gamepad'
            // Add more icons as needed
        };
        return icons[appName] || 'fas fa-window-maximize';
    }
});

</script>


</body>
</html>
